<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>19 Factorial ANOVA | Reproducible statistics for psychologists with R</title>
<meta name="author" content="Matthew J. C. Crump">
<meta name="description" content="19.1 Reading Chapter 16 from Abdi, Edelman, Dowling, &amp; Valentin81. See also Chapters 9 and 10 from Crump, Navarro, &amp; Suzuki82 on factorial designs.   19.2 Overview This lab includes practical and...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="19 Factorial ANOVA | Reproducible statistics for psychologists with R">
<meta property="og:type" content="book">
<meta property="og:description" content="19.1 Reading Chapter 16 from Abdi, Edelman, Dowling, &amp; Valentin81. See also Chapters 9 and 10 from Crump, Navarro, &amp; Suzuki82 on factorial designs.   19.2 Overview This lab includes practical and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="19 Factorial ANOVA | Reproducible statistics for psychologists with R">
<meta name="twitter:description" content="19.1 Reading Chapter 16 from Abdi, Edelman, Dowling, &amp; Valentin81. See also Chapters 9 and 10 from Crump, Navarro, &amp; Suzuki82 on factorial designs.   19.2 Overview This lab includes practical and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Work%20Sans-0.4.1/font.css" rel="stylesheet">
<link href="libs/_Major%20Mono%20Display-0.4.1/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-TJYWEN5QYP"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-TJYWEN5QYP');
    </script><link rel="icon" href="https://crumplab.github.io/rstatsforpsych/favicon.ico">
<meta property="og:card" content="website">
<meta property="og:title" content="19 Factorial ANOVA | Reproducible statistics for psychologists with R">
<meta property="og:image" content="https://crumplab.github.io/rstatsforpsych/imgs/cover.png">
<meta property="og:url" content="https://crumplab.github.io/rstatsforpsych/factorial-anova-1.html">
<meta property="og:description" content="A lab curriculum for psych stats that introduces R and scripting for reproducible analyses.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@MattCrump_">
<meta name="twitter:title" content="19 Factorial ANOVA | Reproducible statistics for psychologists with R">
<meta name="twitter:description" content="A lab curriculum for psych stats that introduces R and scripting for reproducible analyses.">
<meta name="twitter:image" content="https://crumplab.github.io/rstatsforpsych/imgs/rstats_large.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="custom.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Lab Tutorials">Reproducible statistics for psychologists with R</a>:
        <small class="text-muted">Lab Tutorials</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li class="book-part">Getting started</li>
<li><a class="" href="r-rstudio-github.html">R, RStudio, &amp; Github</a></li>
<li><a class="" href="basic-r-programming.html">Basic R programming</a></li>
<li><a class="" href="practice-problems.html">Practice problems</a></li>
<li><a class="" href="coding-reference.html">Coding Reference</a></li>
<li><a class="" href="textbooks-and-other-resources.html">Textbooks and Other Resources</a></li>
<li class="book-part">Semester 1 Labs</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">1</span> R Basics</a></li>
<li><a class="" href="descriptives.html"><span class="header-section-number">2</span> Descriptives</a></li>
<li><a class="" href="distributions-i.html"><span class="header-section-number">3</span> Distributions I</a></li>
<li><a class="" href="distributions-ii.html"><span class="header-section-number">4</span> Distributions II</a></li>
<li><a class="" href="sampling-distributions.html"><span class="header-section-number">5</span> Sampling Distributions</a></li>
<li><a class="" href="statistical-inference.html"><span class="header-section-number">6</span> Statistical Inference</a></li>
<li><a class="" href="binomial-test.html"><span class="header-section-number">7</span> Binomial Test</a></li>
<li><a class="" href="z-tests.html"><span class="header-section-number">8</span> Z tests</a></li>
<li><a class="" href="chi-square.html"><span class="header-section-number">9</span> Chi Square</a></li>
<li><a class="" href="t-tests.html"><span class="header-section-number">10</span> T-tests</a></li>
<li><a class="" href="simulation-and-power-analysis.html">Simulation and Power Analysis</a></li>
<li><a class="" href="correlation.html"><span class="header-section-number">11</span> Correlation</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">12</span> Regression</a></li>
<li><a class="" href="semester-1-project.html">Semester 1 project</a></li>
<li class="book-part">Semester 2 Labs</li>
<li><a class="" href="shaping-data.html"><span class="header-section-number">13</span> Shaping Data</a></li>
<li><a class="" href="multiple-regression-i.html"><span class="header-section-number">14</span> Multiple Regression I</a></li>
<li><a class="" href="multiple-regression-ii.html"><span class="header-section-number">15</span> Multiple Regression II”</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">16</span> ANOVA</a></li>
<li><a class="" href="anova-and-randomization.html"><span class="header-section-number">17</span> ANOVA and Randomization</a></li>
<li><a class="" href="linear-contrasts.html"><span class="header-section-number">18</span> Linear Contrasts</a></li>
<li><a class="active" href="factorial-anova-1.html"><span class="header-section-number">19</span> Factorial ANOVA</a></li>
<li><a class="" href="factorial-ii.html"><span class="header-section-number">20</span> Factorial II</a></li>
<li><a class="" href="repeated-measures-anova.html"><span class="header-section-number">21</span> Repeated Measures ANOVA</a></li>
<li><a class="" href="nested-designs.html"><span class="header-section-number">22</span> Nested Designs</a></li>
<li><a class="" href="wyor.html"><span class="header-section-number">23</span> WYOR</a></li>
<li><a class="" href="semester-project-2021.html"><span class="header-section-number">24</span> Semester Project 2021</a></li>
<li><a class="" href="semester-project-2022.html"><span class="header-section-number">25</span> Semester Project 2022</a></li>
<li><a class="" href="references-12.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/CrumpLab/rstatsforpsych">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="factorial-anova-1" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Factorial ANOVA<a class="anchor" aria-label="anchor" href="#factorial-anova-1"><i class="fas fa-link"></i></a>
</h1>
<div id="reading-9" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Reading<a class="anchor" aria-label="anchor" href="#reading-9"><i class="fas fa-link"></i></a>
</h2>
<p>Chapter 16 from <span class="citation">Abdi, Edelman, Dowling, &amp; Valentin<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references-12.html#ref-abdiExperimentalDesignAnalysis2009" role="doc-biblioref"&gt;2009&lt;/a&gt;.&lt;/p&gt;'><sup>81</sup></a></span>. See also Chapters <a href="https://crumplab.github.io/statistics/factorial-anova.html">9</a> and <a href="https://crumplab.github.io/statistics/more-on-factorial-designs.html">10</a> from <span class="citation">Crump, Navarro, &amp; Suzuki<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references-12.html#ref-crumpAnsweringQuestionsData2018" role="doc-biblioref"&gt;2018&lt;/a&gt;.&lt;/p&gt;'><sup>82</sup></a></span> on factorial designs.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/hjQ3DC2dIcc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="overview-20" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> Overview<a class="anchor" aria-label="anchor" href="#overview-20"><i class="fas fa-link"></i></a>
</h2>
<p>This lab includes practical and conceptual introduction to factorial ANOVAs in R. The practical sections show how to use the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function to compute ANOVAs for designs with multiple independent variables, and shows how to compute the textbook examples in R. The conceptual sections make use of R as a tool to illustrate the ideas of main effects and statistical interactions.</p>
</div>
<div id="practical-1-factorial-anovas-using-aov" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Practical 1: Factorial ANOVAs using aov()<a class="anchor" aria-label="anchor" href="#practical-1-factorial-anovas-using-aov"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function we have used for one-factor ANOVAs will also conduct ANOVAs with mutiple factors. The new requirements are:</p>
<ol style="list-style-type: decimal">
<li><p>A long dataframe with columns for each factor (independent variable) and measurements (dependent variable)</p></li>
<li><p>A formula instructing the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function to compute the intended ANOVA</p></li>
</ol>
<div id="example-long-data-frame" class="section level3" number="19.3.1">
<h3>
<span class="header-section-number">19.3.1</span> Example long data frame<a class="anchor" aria-label="anchor" href="#example-long-data-frame"><i class="fas fa-link"></i></a>
</h3>
<p>Designs with multiple independent variables can become fairly complicated. This example uses a 2x2 design. There are two independent variables with two levels each. The design is crossed, or fully factorial, such that each level of one IV is paired with every level of the other IV.</p>
<div class="sourceCode" id="cb626"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>

<span class="co"># set number of subjects per cell</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">factorial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>,<span class="st">"L2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                         B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>,<span class="st">"L2"</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                         DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="example-anova-formula" class="section level3" number="19.3.2">
<h3>
<span class="header-section-number">19.3.2</span> Example ANOVA formula<a class="anchor" aria-label="anchor" href="#example-anova-formula"><i class="fas fa-link"></i></a>
</h3>
<p>The formula for <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> is similar to before. The general syntax is <code>DV_column_name ~ IV1_column_name * IV2_column_name</code>. The most important new element is the <code>*</code> symbol. This instructs the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function to compute all of the possible main effects and interactions.</p>
<p>In the example below I replaced each of the variable names with the names of the respective columns in the <code>factorial_data</code> tibble.</p>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">factorial_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; A            1  0.132  0.1317   0.273 0.6088  </span>
<span class="co">#&gt; B            1  0.592  0.5925   1.226 0.2845  </span>
<span class="co">#&gt; A:B          1  1.904  1.9044   3.941 0.0645 .</span>
<span class="co">#&gt; Residuals   16  7.731  0.4832                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html">model.tables</a></span><span class="op">(</span><span class="va">aov_out</span>, type <span class="op">=</span> <span class="st">"means"</span><span class="op">)</span>
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt; -0.114805 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  A </span>
<span class="co">#&gt; A</span>
<span class="co">#&gt;       L1       L2 </span>
<span class="co">#&gt; -0.19595 -0.03366 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  B </span>
<span class="co">#&gt; B</span>
<span class="co">#&gt;       L1       L2 </span>
<span class="co">#&gt; -0.28692  0.05731 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  A:B </span>
<span class="co">#&gt;     B</span>
<span class="co">#&gt; A    L1      L2     </span>
<span class="co">#&gt;   L1 -0.6766  0.2847</span>
<span class="co">#&gt;   L2  0.1028 -0.1701</span></code></pre></div>
<p>Briefly, if you had factorial design with three IVs, you would another <code>*</code> in the formula along with the name of the third IV. For example, <code>DV_name ~ IV1_name * IV2_name * IV3_name</code>.</p>
</div>
<div id="three-factor-example" class="section level3" number="19.3.3">
<h3>
<span class="header-section-number">19.3.3</span> Three factor example<a class="anchor" aria-label="anchor" href="#three-factor-example"><i class="fas fa-link"></i></a>
</h3>
<p>As an exercise, consider how you would modify the above example code to create simulated random data for a design with three IVs, each with two levels. This would be defined as a 2x2x2 design. I’ve provided example code below.</p>
<div class="sourceCode" id="cb628"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="va">factorial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>,<span class="st">"L2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                         B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>,<span class="st">"L2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
                         C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>,<span class="st">"L2"</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                         DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span><span class="op">*</span><span class="va">C</span>, data <span class="op">=</span> <span class="va">factorial_data</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; A            1  0.117   0.117   0.066  0.800</span>
<span class="co">#&gt; B            1  2.483   2.483   1.405  0.253</span>
<span class="co">#&gt; C            1  0.433   0.433   0.245  0.627</span>
<span class="co">#&gt; A:B          1  0.044   0.044   0.025  0.876</span>
<span class="co">#&gt; A:C          1  4.362   4.362   2.468  0.136</span>
<span class="co">#&gt; B:C          1  0.498   0.498   0.282  0.603</span>
<span class="co">#&gt; A:B:C        1  5.170   5.170   2.925  0.107</span>
<span class="co">#&gt; Residuals   16 28.275   1.767</span></code></pre></div>
</div>
<div id="example-with-ggplot" class="section level3" number="19.3.4">
<h3>
<span class="header-section-number">19.3.4</span> Example with ggplot<a class="anchor" aria-label="anchor" href="#example-with-ggplot"><i class="fas fa-link"></i></a>
</h3>
<p>When you are analyzing real data you may want to accomplish a number of analysis tasks, such as preserving the data in long-form, looking at means in table, looking at means and data points in graphs, and printing ANOVA summary tables. The following example code shows these steps in one snippet.</p>
<div class="sourceCode" id="cb629"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#load libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>

<span class="co"># simulated data (pretend running an experiment)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">factorial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A1"</span>,<span class="st">"A2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                         B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B1"</span>,<span class="st">"B2"</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                         DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Look at the means in a table</span>
<span class="va">factorial_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DV</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 × 3</span>
<span class="co">#&gt; # Groups:   A [2]</span>
<span class="co">#&gt;   A     B     mean_DV</span>
<span class="co">#&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 A1    B1     -0.133</span>
<span class="co">#&gt; 2 A1    B2      0.659</span>
<span class="co">#&gt; 3 A2    B1     -0.128</span>
<span class="co">#&gt; 4 A2    B2      0.333</span>

<span class="co"># look at the means in a plot</span>
<span class="va">factorial_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">DV</span>, x<span class="op">=</span><span class="va">A</span>, group <span class="op">=</span> <span class="va">B</span>,fill<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"summary"</span>, fun <span class="op">=</span> <span class="st">"mean"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="s2_Lab7_Factorial_ANOVA_files/figure-html/unnamed-chunk-5-1.png" width="100%"></div>
<div class="sourceCode" id="cb630"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># look at plots of the main effects and interaction</span>

<span class="va">A</span> <span class="op">&lt;-</span> <span class="va">factorial_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DV</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">mean_DV</span>, x<span class="op">=</span><span class="va">A</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Main effect A"</span><span class="op">)</span>

<span class="va">B</span> <span class="op">&lt;-</span> <span class="va">factorial_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DV</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">mean_DV</span>, x<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span><span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Main effect B"</span><span class="op">)</span>

<span class="va">AB</span> <span class="op">&lt;-</span> <span class="va">factorial_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DV</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">mean_DV</span>, x<span class="op">=</span><span class="va">A</span>, fill<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span><span class="op">+</span> 
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"AxB Interaction"</span><span class="op">)</span>

<span class="co"># patchwork formula</span>
<span class="op">(</span><span class="va">A</span><span class="op">+</span><span class="va">B</span><span class="op">)</span><span class="op">/</span><span class="va">AB</span></code></pre></div>
<div class="inline-figure"><img src="s2_Lab7_Factorial_ANOVA_files/figure-html/unnamed-chunk-5-2.png" width="100%"></div>
<div class="sourceCode" id="cb631"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># ANOVA table</span>
<span class="co"># print to console</span>
<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">factorial_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; A            1  0.130  0.1296   0.094  0.763</span>
<span class="co">#&gt; B            1  1.960  1.9605   1.428  0.249</span>
<span class="co">#&gt; A:B          1  0.137  0.1367   0.100  0.756</span>
<span class="co">#&gt; Residuals   16 21.959  1.3724</span>

<span class="co"># ANOVA means</span>
<span class="co"># print to console</span>
<span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html">model.tables</a></span><span class="op">(</span><span class="va">aov_out</span>, type <span class="op">=</span> <span class="st">"means"</span><span class="op">)</span>
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt; 0.1826051 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  A </span>
<span class="co">#&gt; A</span>
<span class="co">#&gt;      A1      A2 </span>
<span class="co">#&gt; 0.26311 0.10210 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  B </span>
<span class="co">#&gt; B</span>
<span class="co">#&gt;      B1      B2 </span>
<span class="co">#&gt; -0.1305  0.4957 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  A:B </span>
<span class="co">#&gt;     B</span>
<span class="co">#&gt; A    B1      B2     </span>
<span class="co">#&gt;   A1 -0.1326  0.6589</span>
<span class="co">#&gt;   A2 -0.1283  0.3325</span></code></pre></div>
</div>
</div>
<div id="practical-2-textbook-examples" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> Practical 2: Textbook examples<a class="anchor" aria-label="anchor" href="#practical-2-textbook-examples"><i class="fas fa-link"></i></a>
</h2>
<div id="model-i-fixed-effects" class="section level3" number="19.4.1">
<h3>
<span class="header-section-number">19.4.1</span> Model I Fixed effects<a class="anchor" aria-label="anchor" href="#model-i-fixed-effects"><i class="fas fa-link"></i></a>
</h3>
<p>By default the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function computes model I sums of squares for fixed effects. Here we use the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function to compute the “cute cued recall” example in section 16.7. Represent the data from table 16.3, generate a plot similar to figure 16.4, compute the ANOVA table from page 306.</p>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a1b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">9</span>,<span class="fl">7</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">7</span>,<span class="fl">12</span>,<span class="fl">11</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">a1b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">12</span>,<span class="fl">7</span>,<span class="fl">9</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">10</span>,<span class="fl">7</span>,<span class="fl">12</span><span class="op">)</span>
<span class="va">a2b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">13</span>,<span class="fl">18</span>,<span class="fl">19</span>,<span class="fl">13</span>,<span class="fl">8</span>,<span class="fl">15</span>,<span class="fl">13</span>,<span class="fl">9</span>,<span class="fl">8</span>,<span class="fl">14</span><span class="op">)</span>
<span class="va">a2b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">13</span>,<span class="fl">21</span>,<span class="fl">20</span>,<span class="fl">15</span>,<span class="fl">17</span>,<span class="fl">14</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">16</span>,<span class="fl">7</span><span class="op">)</span>
<span class="va">a3b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">17</span>,<span class="fl">20</span>,<span class="fl">22</span>,<span class="fl">13</span>,<span class="fl">21</span>,<span class="fl">16</span>,<span class="fl">23</span>,<span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">19</span><span class="op">)</span>
<span class="va">a3b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">31</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">29</span>,<span class="fl">30</span>,<span class="fl">33</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">28</span><span class="op">)</span>

<span class="va">recall_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>words_recalled <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a1b1</span>,<span class="va">a1b2</span>,
                                         <span class="va">a2b1</span>,<span class="va">a2b2</span>,
                                         <span class="va">a3b1</span>,<span class="va">a3b2</span><span class="op">)</span>,
                      A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"12 words"</span>,
                                <span class="st">"24 words"</span>,
                                <span class="st">"48 words"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
                      B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Free recall"</span>,
                                <span class="st">"Cued Recall"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
                      <span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recall_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">A</span>, y<span class="op">=</span><span class="va">words_recalled</span>, group <span class="op">=</span> <span class="va">B</span>, linetype<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"summary"</span>, fun<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"summary"</span>, fun<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="s2_Lab7_Factorial_ANOVA_files/figure-html/unnamed-chunk-6-1.png" width="100%"></div>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">words_recalled</span> <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">recall_data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="co">#&gt; A            2   2080    1040  115.56  &lt; 2e-16 ***</span>
<span class="co">#&gt; B            1    240     240   26.67 3.58e-06 ***</span>
<span class="co">#&gt; A:B          2    280     140   15.56 4.62e-06 ***</span>
<span class="co">#&gt; Residuals   54    486       9                     </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html">model.tables</a></span><span class="op">(</span><span class="va">aov_out</span>, type<span class="op">=</span><span class="st">"means"</span><span class="op">)</span>
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;    </span>
<span class="co">#&gt; 16 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  A </span>
<span class="co">#&gt; A</span>
<span class="co">#&gt; 12 words 24 words 48 words </span>
<span class="co">#&gt;       10       14       24 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  B </span>
<span class="co">#&gt; B</span>
<span class="co">#&gt; Cued Recall Free recall </span>
<span class="co">#&gt;          18          14 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  A:B </span>
<span class="co">#&gt;           B</span>
<span class="co">#&gt; A          Cued Recall Free recall</span>
<span class="co">#&gt;   12 words 10          10         </span>
<span class="co">#&gt;   24 words 15          13         </span>
<span class="co">#&gt;   48 words 29          19</span></code></pre></div>
</div>
<div id="model-ii-random-effects" class="section level3" number="19.4.2">
<h3>
<span class="header-section-number">19.4.2</span> Model II Random effects<a class="anchor" aria-label="anchor" href="#model-ii-random-effects"><i class="fas fa-link"></i></a>
</h3>
<p>When both of the factors are random, the F-ratios are computed in a different manner (see textbook). This example covers section 16.8.4 from the textbook, involving example data with two random factors.</p>
<p>Note, we use the <code>Anova()</code> function from the <code>car</code> package, which provides a way to specify the type of sums of squares.</p>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">127</span>,<span class="fl">121</span>,<span class="fl">117</span>,<span class="fl">109</span>,<span class="fl">107</span>,<span class="fl">101</span>,<span class="fl">98</span>,<span class="fl">94</span>,<span class="fl">97</span>,<span class="fl">89</span><span class="op">)</span>
<span class="va">A2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">117</span>,<span class="fl">109</span>,<span class="fl">113</span>,<span class="fl">113</span>,<span class="fl">108</span>,<span class="fl">104</span>,<span class="fl">95</span>,<span class="fl">93</span>,<span class="fl">96</span>,<span class="fl">92</span><span class="op">)</span>
<span class="va">A3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">111</span>,<span class="fl">111</span>,<span class="fl">111</span>,<span class="fl">101</span>,<span class="fl">99</span>,<span class="fl">91</span>,<span class="fl">95</span>,<span class="fl">89</span>,<span class="fl">89</span>,<span class="fl">83</span><span class="op">)</span>
<span class="va">A4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">108</span>,<span class="fl">100</span>,<span class="fl">100</span>,<span class="fl">92</span>,<span class="fl">92</span>,<span class="fl">90</span>,<span class="fl">87</span>,<span class="fl">77</span>,<span class="fl">89</span>,<span class="fl">85</span><span class="op">)</span>

<span class="va">random_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>scores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">A1</span>,<span class="va">A2</span>,<span class="va">A3</span>,<span class="va">A4</span><span class="op">)</span>,
                      A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,
                      B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,each<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
                      <span class="op">)</span>

<span class="va">aov.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">scores</span> <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">random_data</span><span class="op">)</span>
<span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">aov.lm</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Anova Table (Type II tests)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: scores</span>
<span class="co">#&gt;           Sum Sq Df F value    Pr(&gt;F)    </span>
<span class="co">#&gt; A           1200  3      20 3.102e-06 ***</span>
<span class="co">#&gt; B           3200  4      40 2.836e-09 ***</span>
<span class="co">#&gt; A:B          240 12       1    0.4827    </span>
<span class="co">#&gt; Residuals    400 20                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Finally, the example data will provide identical ANOVA tables for regardless of whether model I or II sums of squares is used. This is because the MSE for the interaction term and for the residual error term are the same for this example data. So, even though it looks like we are getting the same answer from the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function, it is computing model I and not model II.</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">scores</span> <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">random_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="co">#&gt; A            3   1200     400      20 3.10e-06 ***</span>
<span class="co">#&gt; B            4   3200     800      40 2.84e-09 ***</span>
<span class="co">#&gt; A:B         12    240      20       1    0.483    </span>
<span class="co">#&gt; Residuals   20    400      20                     </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
</div>
<div id="model-iii-mixed-models-one-fixedone-random" class="section level3" number="19.4.3">
<h3>
<span class="header-section-number">19.4.3</span> Model III Mixed models (one fixed/one random)<a class="anchor" aria-label="anchor" href="#model-iii-mixed-models-one-fixedone-random"><i class="fas fa-link"></i></a>
</h3>
<p>The textbook briefly mentions model III, but does not give a worked example. For now, I’m going to leave this section blank; however, mixed models are fairly common in Psychology and I will plan to return to this section with some brief examples.</p>
</div>
</div>
<div id="conceptual-1-factorial-anova-and-family-wise-error" class="section level2" number="19.5">
<h2>
<span class="header-section-number">19.5</span> Conceptual 1: Factorial ANOVA and family-wise error<a class="anchor" aria-label="anchor" href="#conceptual-1-factorial-anova-and-family-wise-error"><i class="fas fa-link"></i></a>
</h2>
<p>Factorial designs include multiple independent variables and their interactions. As the number of independent variables increase, the number of independent tests also increase. For example, in a 2x2 design, there are three independent tests: one for each main effect, and one for the interaction.</p>
<p>Here we consider family-wise error rate issue with factorial ANOVAs. We will conduct a simulation of the null model for 10,000 2x2 ANOVAs. For each simulation we will record the p-value for each main effect and interaction. We will set an alpha criterion of p &lt; .05. Our question is: out of 10,000 simulated experiments, how many type 1 errors will be made?</p>
<p>Remember, in a one-factor ANOVA, by definition the number of type I errors made by the null should be the same as the alpha criterion, or 5% in our case. Will this also be true for the 2x2 factorial ANOVA?</p>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set up tibble to save simulation values</span>
<span class="va">save_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># loop to conduct i number of simulations</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co">#simulate null data for a 2x2</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>
  <span class="va">factorial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>,<span class="st">"L2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                           B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>,<span class="st">"L2"</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>,
                           DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># compute ANOVA</span>
  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DV</span><span class="op">~</span><span class="va">A</span><span class="op">*</span><span class="va">B</span>, data<span class="op">=</span><span class="va">factorial_data</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co">#save p-values for each effect</span>
  <span class="va">sim_tibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>p_vals <span class="op">=</span> <span class="va">output</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,
                       effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"AxB"</span><span class="op">)</span>,
                       sim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">i</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co">#add the saved values to the overall tibble</span>
  <span class="va">save_sim</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">save_sim</span>,<span class="va">sim_tibble</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>What proportion of the total number of simulated experiments made a type 1 error?</p>
<div class="sourceCode" id="cb637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">type_I_errors</span> <span class="op">&lt;-</span> <span class="va">save_sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">p_vals</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span>
  
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">type_I_errors</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">10000</span>
<span class="co">#&gt; [1] 0.1413</span></code></pre></div>
<p>If we look at the type I error rates separately for each main effect and interaction what do we find?</p>
<div class="sourceCode" id="cb638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">save_sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>type_I_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">p_vals</span><span class="op">[</span><span class="va">p_vals</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">10000</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 × 2</span>
<span class="co">#&gt;   effect type_I_error</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 A            0.0524</span>
<span class="co">#&gt; 2 AxB          0.0537</span>
<span class="co">#&gt; 3 B            0.0491</span></code></pre></div>
<p>The conclusion here is Factorial ANOVAs are not protected against family-wise type I error rate. As you increase the number of IVs, you will increase the likelihood of finding at least one “significant” effect among the main effects and interactions.</p>
<p>Finally, here’s a quick alternative simulation using <code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code>. I set the number of simulations to 10000, the size to 3 (representing three independent tests), and I set the probability of getting 1 to .05. Last, I counted how many of results had a value greater than 0 (representing a type I error), and divided by 10000 (the number of simulations) to estimate the family-wise error rate.</p>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">10000</span>,<span class="fl">3</span>,<span class="fl">.05</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">a</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">10000</span>
<span class="co">#&gt; [1] 0.1355</span></code></pre></div>
</div>
<div id="lab-7-generalization-assignment-1" class="section level2" number="19.6">
<h2>
<span class="header-section-number">19.6</span> Lab 7 Generalization Assignment<a class="anchor" aria-label="anchor" href="#lab-7-generalization-assignment-1"><i class="fas fa-link"></i></a>
</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/MLYxtyahY14" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="instructions-18" class="section level3" number="19.6.1">
<h3>
<span class="header-section-number">19.6.1</span> Instructions<a class="anchor" aria-label="anchor" href="#instructions-18"><i class="fas fa-link"></i></a>
</h3>
<p>Your assignment instructions are the following:</p>
<ol style="list-style-type: decimal">
<li>Work inside the new R project for stats II that you created</li>
<li>Create a new R Markdown document called “Lab7.Rmd”</li>
<li>Use Lab7.Rmd to show your work attempting to solve the following generalization problems. Commit your work regularly so that it appears on your Github repository.</li>
<li>
<strong>For each problem, make a note about how much of the problem you believe you can solve independently without help</strong>. For example, if you needed to watch the help video and are unable to solve the problem on your own without copying the answers, then your note would be 0. If you are confident you can complete the problem from scratch completely on your own, your note would be 100. It is OK to have all 0s or 100s anything in between.</li>
<li>Submit your github repository link for Lab 7 on blackboard.</li>
</ol>
</div>
<div id="problems-17" class="section level3" number="19.6.2">
<h3>
<span class="header-section-number">19.6.2</span> Problems<a class="anchor" aria-label="anchor" href="#problems-17"><i class="fas fa-link"></i></a>
</h3>
<p>There are four problems each worth 3 points. Choose two of the four. If you complete more than two, then you will receive bonus points.</p>
<ol style="list-style-type: decimal">
<li><p>Explain the concept of main effects and interactions with an example using R. For example, this could include a definition of main effects and interactions and a figure depicting main effects and an interaction along with an explanation of the patterns for each. A major point of this problem is for you to to engage in the task of developing an explanation of these concepts that would 1) be helpful for you to understand the concepts, and 2) could be helpful for others to understand these concepts. (3 points)</p></li>
<li><p>Complete the 2x2 factorial lab found here <a href="https://crumplab.github.io/statisticsLab/lab-10-factorial-anova.html" class="uri">https://crumplab.github.io/statisticsLab/lab-10-factorial-anova.html</a>, up to section 10.4.8. More specifically, your task is to follow that lab exercise to load in the data, transform the data into long-format, conduct a 2x2 between subjects ANOVA, and write a short results section reporting the main effects and interaction. (3 points)</p></li>
<li><p>In chapter 10 of <span class="citation">Crump, Navarro, &amp; Suzuki<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references-12.html#ref-crumpAnsweringQuestionsData2018" role="doc-biblioref"&gt;2018&lt;/a&gt;.&lt;/p&gt;'><sup>83</sup></a></span>, there is a discussion of patterns of main effects and interactions that can occur in a 2x2 design, which represents perhaps the simplest factorial design. There are 8 possible outcomes discussed <a href="https://crumplab.github.io/statistics/more-on-factorial-designs.html#looking-at-main-effects-and-interactions" class="uri">https://crumplab.github.io/statistics/more-on-factorial-designs.html#looking-at-main-effects-and-interactions</a>. Examples of these 8 outcomes are shown in two figures, one with bar graphs, and one with line graphs. Reproduce either of these figures using ggplot2. (3 points)</p></li>
<li><p>In the conceptual section of this lab we used an R simulation to find the family-wise type I error rate for a simple factorial design with 2 independent variables. Use an R simulation to find the family-wise type I error rate for a factorial design with 3 independent variables. (3 points)</p></li>
<li><p>Show that a 2x2 factorial ANOVA can be accomplished by using a one-factor ANOVA with three linear contrasts. (3 points)</p></li>
</ol>
</div>
</div>
<div id="references-6" class="section level2" number="19.7">
<h2>
<span class="header-section-number">19.7</span> References<a class="anchor" aria-label="anchor" href="#references-6"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="linear-contrasts.html"><span class="header-section-number">18</span> Linear Contrasts</a></div>
<div class="next"><a href="factorial-ii.html"><span class="header-section-number">20</span> Factorial II</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#factorial-anova-1"><span class="header-section-number">19</span> Factorial ANOVA</a></li>
<li><a class="nav-link" href="#reading-9"><span class="header-section-number">19.1</span> Reading</a></li>
<li><a class="nav-link" href="#overview-20"><span class="header-section-number">19.2</span> Overview</a></li>
<li>
<a class="nav-link" href="#practical-1-factorial-anovas-using-aov"><span class="header-section-number">19.3</span> Practical 1: Factorial ANOVAs using aov()</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#example-long-data-frame"><span class="header-section-number">19.3.1</span> Example long data frame</a></li>
<li><a class="nav-link" href="#example-anova-formula"><span class="header-section-number">19.3.2</span> Example ANOVA formula</a></li>
<li><a class="nav-link" href="#three-factor-example"><span class="header-section-number">19.3.3</span> Three factor example</a></li>
<li><a class="nav-link" href="#example-with-ggplot"><span class="header-section-number">19.3.4</span> Example with ggplot</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#practical-2-textbook-examples"><span class="header-section-number">19.4</span> Practical 2: Textbook examples</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#model-i-fixed-effects"><span class="header-section-number">19.4.1</span> Model I Fixed effects</a></li>
<li><a class="nav-link" href="#model-ii-random-effects"><span class="header-section-number">19.4.2</span> Model II Random effects</a></li>
<li><a class="nav-link" href="#model-iii-mixed-models-one-fixedone-random"><span class="header-section-number">19.4.3</span> Model III Mixed models (one fixed/one random)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#conceptual-1-factorial-anova-and-family-wise-error"><span class="header-section-number">19.5</span> Conceptual 1: Factorial ANOVA and family-wise error</a></li>
<li>
<a class="nav-link" href="#lab-7-generalization-assignment-1"><span class="header-section-number">19.6</span> Lab 7 Generalization Assignment</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#instructions-18"><span class="header-section-number">19.6.1</span> Instructions</a></li>
<li><a class="nav-link" href="#problems-17"><span class="header-section-number">19.6.2</span> Problems</a></li>
</ul>
</li>
<li><a class="nav-link" href="#references-6"><span class="header-section-number">19.7</span> References</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/CrumpLab/rstatsforpsych/blob/master/s2_Lab7_Factorial_ANOVA.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/CrumpLab/rstatsforpsych/edit/master/s2_Lab7_Factorial_ANOVA.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Reproducible statistics for psychologists with R</strong>: Lab Tutorials" was written by Matthew J. C. Crump. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
